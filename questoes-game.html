<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest√µes Game 3D - Quiron Admin</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1d2e;
            color: white;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid white;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 13px;
        }

        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 30px;
        }

        .toolbar {
            background: #252837;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .search-box input {
            padding: 12px 20px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            font-size: 14px;
            background: rgba(255,255,255,0.05);
            color: white;
            min-width: 300px;
        }

        .search-box input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            font-size: 14px;
            background: rgba(255,255,255,0.05);
            color: white;
            cursor: pointer;
        }

        .layout {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 30px;
        }

        .sidebar {
            background: #252837;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            padding: 25px;
            height: fit-content;
            position: sticky;
            top: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar h3 {
            font-size: 16px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .area-cards {
            display: grid;
            gap: 15px;
        }

        .area-card {
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid;
            position: relative;
            overflow: hidden;
        }

        .area-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }

        .area-card:hover::before {
            opacity: 0.5;
        }

        .area-card.juridica {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

        .area-card.juridica.active {
            background: rgba(59, 130, 246, 0.2);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
        }

        .area-card.policial {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .area-card.policial.active {
            background: rgba(239, 68, 68, 0.2);
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.3);
        }

        .area-card.fiscal-bancaria {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .area-card.fiscal-bancaria.active {
            background: rgba(245, 158, 11, 0.2);
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
        }

        .area-card.conhecimentos-gerais {
            border-color: #8b5cf6;
            background: rgba(139, 92, 246, 0.1);
        }

        .area-card.conhecimentos-gerais.active {
            background: rgba(139, 92, 246, 0.2);
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
        }

        .area-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .area-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .area-count {
            font-size: 13px;
            opacity: 0.7;
        }

        .materias-list {
            margin-top: 15px;
            display: none;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .materias-list.show {
            display: block;
        }

        .materia-item {
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            background: rgba(255,255,255,0.05);
            border-left: 3px solid transparent;
        }

        .materia-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .materia-item.active {
            background: rgba(255,255,255,0.15);
            border-left-color: currentColor;
            font-weight: 600;
        }

        .main-content {
            background: #252837;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            padding: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .content-header h2 {
            font-size: 22px;
        }

        .stats-bar {
            display: flex;
            gap: 30px;
            font-size: 13px;
            color: rgba(255,255,255,0.7);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-number {
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        .questions-grid {
            display: grid;
            gap: 20px;
        }

        .question-card {
            background: rgba(255,255,255,0.03);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s;
        }

        .question-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .question-id {
            font-size: 12px;
            font-weight: 600;
            color: #667eea;
            background: rgba(102, 126, 234, 0.2);
            padding: 5px 12px;
            border-radius: 6px;
        }

        .question-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tag {
            font-size: 11px;
            padding: 5px 12px;
            border-radius: 6px;
            font-weight: 600;
        }

        .tag-area {
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .tag-subject {
            background: rgba(139, 92, 246, 0.2);
            color: #c4b5fd;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .tag-difficulty {
            padding: 5px 12px;
            border-radius: 6px;
            font-weight: 600;
        }

        .tag-difficulty.facil {
            background: rgba(16, 185, 129, 0.2);
            color: #6ee7b7;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .tag-difficulty.medio {
            background: rgba(245, 158, 11, 0.2);
            color: #fcd34d;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .tag-difficulty.dificil {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .question-text {
            font-size: 16px;
            line-height: 1.6;
            margin: 20px 0;
            color: rgba(255,255,255,0.9);
        }

        .answer-box {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .answer-box.correct {
            background: rgba(16, 185, 129, 0.15);
            border: 2px solid rgba(16, 185, 129, 0.3);
        }

        .answer-box.incorrect {
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid rgba(239, 68, 68, 0.3);
        }

        .answer-icon {
            font-size: 28px;
        }

        .answer-label {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .explanation {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
        }

        .explanation-title {
            font-size: 13px;
            font-weight: 700;
            color: #93c5fd;
            margin-bottom: 8px;
        }

        .explanation-text {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
            line-height: 1.6;
        }

        .question-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: #252837;
            border-radius: 20px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .modal-header h2 {
            font-size: 24px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            font-size: 14px;
            background: rgba(255,255,255,0.05);
            color: white;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid rgba(255,255,255,0.1);
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: rgba(255,255,255,0.5);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>
            <span>üéÆ</span>
            Quest√µes Game 3D (Certo/Errado)
        </h1>
        <button class="btn btn-secondary" onclick="window.location.href='dashboard.html'">
            ‚Üê Voltar ao Dashboard
        </button>
    </div>

    <div class="container">
        <!-- Toolbar -->
        <div class="toolbar">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="üîç Buscar quest√µes..." onkeyup="filterQuestions()">
            </div>
            <div class="filters">
                <select class="filter-select" id="filterDifficulty" onchange="filterQuestions()">
                    <option value="">‚ö° Todas Dificuldades</option>
                    <option value="facil">F√°cil</option>
                    <option value="medio">M√©dio</option>
                    <option value="dificil">Dif√≠cil</option>
                </select>
                <select class="filter-select" id="filterAnswer" onchange="filterQuestions()">
                    <option value="">‚úÖ Todas Respostas</option>
                    <option value="true">Certo</option>
                    <option value="false">Errado</option>
                </select>
                <button class="btn btn-success" onclick="openAddModal()">
                    ‚ûï Nova Quest√£o
                </button>
            </div>
        </div>

        <!-- Layout -->
        <div class="layout">
            <!-- Sidebar -->
            <div class="sidebar">
                <h3>üéØ √Åreas Tem√°ticas</h3>
                <div class="area-cards" id="areaCards">
                    <!-- Carregado dinamicamente -->
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <div class="content-header">
                    <div>
                        <h2 id="contentTitle">Todas as Quest√µes</h2>
                    </div>
                    <div class="stats-bar">
                        <div class="stat-item">
                            <span class="stat-number" id="statTotal">0</span>
                            <span>quest√µes</span>
                        </div>
                    </div>
                </div>

                <div id="questionsContainer">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Carregando quest√µes...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="questionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">‚ûï Nova Quest√£o</h2>
            </div>

            <form id="questionForm">
                <div class="form-group">
                    <label>ID da Quest√£o *</label>
                    <input type="text" id="inputId" required placeholder="Ex: const-01">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>√Årea *</label>
                        <select id="inputArea" required onchange="updateSubjectsList()">
                            <option value="">Selecione...</option>
                            <option value="juridica">üìò Jur√≠dica</option>
                            <option value="policial">üöî Policial</option>
                            <option value="fiscal-bancaria">üí∞ Fiscal-Banc√°ria</option>
                            <option value="conhecimentos-gerais">üß† Conhecimentos Gerais</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Mat√©ria *</label>
                        <select id="inputSubject" required>
                            <option value="">Selecione √°rea primeiro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Dificuldade *</label>
                        <select id="inputDifficulty" required>
                            <option value="">Selecione...</option>
                            <option value="facil">F√°cil</option>
                            <option value="medio">M√©dio</option>
                            <option value="dificil">Dif√≠cil</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Enunciado *</label>
                    <textarea id="inputEnunciado" required placeholder="Digite o enunciado da quest√£o..."></textarea>
                </div>

                <div class="form-group">
                    <label>Resposta Correta *</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="answer" value="true" id="answerTrue">
                            ‚úÖ Certo
                        </label>
                        <label>
                            <input type="radio" name="answer" value="false" id="answerFalse">
                            ‚ùå Errado
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Explica√ß√£o *</label>
                    <textarea id="inputExplicacao" required placeholder="Digite a explica√ß√£o detalhada..."></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeModal()">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-success" style="flex: 1;">
                        üíæ Salvar Quest√£o
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://lrmabyfaunhrdvdzocrz.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxybWFieWZhdW5ocmR2ZHpvY3J6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNDQ4NDUsImV4cCI6MjA3ODkyMDg0NX0.XALJ51MUjxw93j4NkJu3cFusKOAIY1LlClg_tbIy_r0';

        if (localStorage.getItem('quiron_admin_logged') !== 'true') {
            window.location.href = 'index.html';
        }

        const ESTRUTURA_GAME = {
            juridica: {
                nome: '√Årea Jur√≠dica',
                icon: 'üéØ',
                subjects: ['Direito Constitucional', 'Direito Administrativo', 'Direito Penal', 'Direito Civil', 'Direito do Trabalho']
            },
            policial: {
                nome: '√Årea Policial',
                icon: 'üî•',
                subjects: ['Legisla√ß√£o Penal Especial', 'Criminologia', 'Direitos Humanos', 'Procedimentos Policiais']
            },
            'fiscal-bancaria': {
                nome: '√Årea Fiscal-Banc√°ria',
                icon: 'üëë',
                subjects: ['AFO', 'Contabilidade', 'Economia', 'Conhecimentos Banc√°rios', 'Matem√°tica Financeira']
            },
            'conhecimentos-gerais': {
                nome: 'Conhecimentos Gerais',
                icon: '‚ö°',
                subjects: ['Portugu√™s', 'Racioc√≠nio L√≥gico', 'Inform√°tica', 'Atualidades', 'Hist√≥ria']
            }
        };

        let allQuestions = [];
        let filteredQuestions = [];
        let currentArea = null;
        let currentSubject = null;
        let editingQuestion = null;

        document.addEventListener('DOMContentLoaded', () => {
            loadAreasSidebar();
            loadQuestions();
        });

        function loadAreasSidebar() {
            const container = document.getElementById('areaCards');
            let html = '';

            for (const [key, data] of Object.entries(ESTRUTURA_GAME)) {
                html += `
                    <div class="area-card ${key}" onclick="toggleArea('${key}')">
                        <div class="area-icon">${data.icon}</div>
                        <div class="area-name">${data.nome}</div>
                        <div class="area-count" id="count-${key}">0 quest√µes</div>
                        
                        <div class="materias-list" id="materias-${key}">
                `;

                data.subjects.forEach(subject => {
                    html += `
                        <div class="materia-item" onclick="selectSubject('${key}', '${subject}', event)">
                            ${subject}
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function toggleArea(area) {
            const materiasList = document.getElementById(`materias-${area}`);
            const card = event.currentTarget;
            
            document.querySelectorAll('.area-card').forEach(c => {
                if (c !== card) {
                    c.classList.remove('active');
                    const list = c.querySelector('.materias-list');
                    if (list) list.classList.remove('show');
                }
            });

            card.classList.toggle('active');
            materiasList.classList.toggle('show');

            currentArea = card.classList.contains('active') ? area : null;
            currentSubject = null;
            
            document.querySelectorAll('.materia-item').forEach(el => el.classList.remove('active'));
            
            document.getElementById('contentTitle').textContent = 
                currentArea ? ESTRUTURA_GAME[currentArea].nome : 'Todas as Quest√µes';
            
            filterQuestions();
        }

        function selectSubject(area, subject, event) {
            event.stopPropagation();
            
            currentArea = area;
            currentSubject = subject;

            document.querySelectorAll('.materia-item').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('contentTitle').textContent = subject;
            filterQuestions();
        }

        function updateSubjectsList() {
            const area = document.getElementById('inputArea').value;
            const subjectSelect = document.getElementById('inputSubject');

            if (!area) {
                subjectSelect.innerHTML = '<option value="">Selecione √°rea primeiro</option>';
                return;
            }

            let html = '<option value="">Selecione...</option>';
            ESTRUTURA_GAME[area].subjects.forEach(subject => {
                html += `<option value="${subject}">${subject}</option>`;
            });

            subjectSelect.innerHTML = html;
        }

        function loadQuestions() {
            allQuestions = generateDemoQuestions();
            filterQuestions();
            updateCounters();
        }

        function filterQuestions() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const difficulty = document.getElementById('filterDifficulty').value;
            const answer = document.getElementById('filterAnswer').value;

            filteredQuestions = allQuestions.filter(q => {
                const matchArea = !currentArea || q.area === currentArea;
                const matchSubject = !currentSubject || q.subject === currentSubject;
                const matchSearch = !search || q.enunciado.toLowerCase().includes(search);
                const matchDifficulty = !difficulty || q.difficulty === difficulty;
                const matchAnswer = !answer || q.answer.toString() === answer;

                return matchArea && matchSubject && matchSearch && matchDifficulty && matchAnswer;
            });

            renderQuestions();
        }

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            document.getElementById('statTotal').textContent = filteredQuestions.length;

            if (filteredQuestions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div>Nenhuma quest√£o encontrada</div>
                    </div>
                `;
                return;
            }

            let html = '<div class="questions-grid">';

            filteredQuestions.forEach(q => {
                const difficultyText = {facil: 'F√°cil', medio: 'M√©dio', dificil: 'Dif√≠cil'};
                
                html += `
                    <div class="question-card">
                        <div class="question-header">
                            <div class="question-id">${q.id}</div>
                            <div class="question-tags">
                                <span class="tag tag-area">${ESTRUTURA_GAME[q.area].nome}</span>
                                <span class="tag tag-subject">${q.subject}</span>
                                <span class="tag-difficulty ${q.difficulty}">${difficultyText[q.difficulty]}</span>
                            </div>
                        </div>

                        <div class="question-text">${q.enunciado}</div>

                        <div class="answer-box ${q.answer ? 'correct' : 'incorrect'}">
                            <div class="answer-icon">${q.answer ? '‚úÖ' : '‚ùå'}</div>
                            <div class="answer-label">${q.answer ? 'Certo' : 'Errado'}</div>
                        </div>

                        <div class="explanation">
                            <div class="explanation-title">üí° Explica√ß√£o:</div>
                            <div class="explanation-text">${q.explicacao}</div>
                        </div>

                        <div class="question-actions">
                            <button class="btn btn-primary btn-sm" onclick='editQuestion(${JSON.stringify(q).replace(/'/g, "&apos;")})'>
                                ‚úèÔ∏è Editar
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="deleteQuestion('${q.id}')">
                                üóëÔ∏è Deletar
                            </button>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function updateCounters() {
            for (const area of Object.keys(ESTRUTURA_GAME)) {
                const count = allQuestions.filter(q => q.area === area).length;
                document.getElementById(`count-${area}`).textContent = `${count} quest√µes`;
            }
        }

        function openAddModal() {
            editingQuestion = null;
            document.getElementById('modalTitle').textContent = '‚ûï Nova Quest√£o';
            document.getElementById('questionForm').reset();
            document.getElementById('questionModal').classList.add('show');
        }

        function editQuestion(question) {
            editingQuestion = question;
            document.getElementById('modalTitle').textContent = '‚úèÔ∏è Editar Quest√£o';

            document.getElementById('inputId').value = question.id;
            document.getElementById('inputArea').value = question.area;
            updateSubjectsList();
            document.getElementById('inputSubject').value = question.subject;
            document.getElementById('inputDifficulty').value = question.difficulty;
            document.getElementById('inputEnunciado').value = question.enunciado;
            document.querySelector(`input[name="answer"][value="${question.answer}"]`).checked = true;
            document.getElementById('inputExplicacao').value = question.explicacao;

            document.getElementById('questionModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('questionModal').classList.remove('show');
        }

        document.getElementById('questionForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const answer = document.querySelector('input[name="answer"]:checked');
            if (!answer) {
                alert('Selecione a resposta correta!');
                return;
            }

            const question = {
                id: document.getElementById('inputId').value,
                area: document.getElementById('inputArea').value,
                subject: document.getElementById('inputSubject').value,
                difficulty: document.getElementById('inputDifficulty').value,
                enunciado: document.getElementById('inputEnunciado').value,
                answer: answer.value === 'true',
                explicacao: document.getElementById('inputExplicacao').value
            };

            if (editingQuestion) {
                const index = allQuestions.findIndex(q => q.id === editingQuestion.id);
                if (index !== -1) {
                    allQuestions[index] = question;
                }
                alert('‚úÖ Quest√£o atualizada!');
            } else {
                allQuestions.push(question);
                alert('‚úÖ Quest√£o adicionada!');
            }

            closeModal();
            filterQuestions();
            updateCounters();
        });

        function deleteQuestion(id) {
            if (!confirm('Deletar esta quest√£o?')) return;
            
            allQuestions = allQuestions.filter(q => q.id !== id);
            alert('‚úÖ Quest√£o deletada!');
            filterQuestions();
            updateCounters();
        }

        function generateDemoQuestions() {
            const questions = [];
            const difficulties = ['facil', 'medio', 'dificil'];
            let id = 1;

            for (const [area, data] of Object.entries(ESTRUTURA_GAME)) {
                data.subjects.forEach(subject => {
                    difficulties.forEach(diff => {
                        for (let i = 0; i < 5; i++) {
                            questions.push({
                                id: `${area}-${id++}`,
                                area: area,
                                subject: subject,
                                difficulty: diff,
                                enunciado: `Quest√£o demo de ${subject} - Dificuldade ${diff} - ${i + 1}`,
                                answer: Math.random() > 0.5,
                                explicacao: `Explica√ß√£o detalhada desta quest√£o sobre ${subject}.`
                            });
                        }
                    });
                });
            }

            return questions;
        }
    </script>
</body>
</html>
